# Loon全局配置 by Tartarus, 根据 MazeTsz 配置改编。
# 会一直随tf特性而变化。不建议商店用户使用。
# Loon教程链接：https://github.com/chiupam/tutorial/blob/master/Loon/Plus/README.md
# Loon规则GitHub：https://github.com/blackmatrix7/ios_rule_script/tree/master/rule/Loon

# 导入配置后,添加订阅,之后更新订阅规则。

# 点击配置-证书管理-生成新的CA证书，之后进入「设置」>「通用」>「描述文件」, 安装Loon的证书, 并在「设置」>「通用」>「关于本机」>「证书信任设置」开启对Loon证书的信任。

# 开启Loon，并在仪表-订阅处更新全部资源。

# 策略组
# 节点选项
# select模式,手动选择模式
# url-test模式, 给提供的url发出http header请求, 根据返回结果, 选择测速最快的节点, 默认间隔600s, 测速超时时间5s, 为了避免资源浪费, 建议节点数不要过多, 只支持单个节点和远端节点, 其他会被忽略
# url-test 策略组添加tolerance参数，用于对比切换节点内时的容差，计算方式如下：(前一次测速最优节点耗时 -减去 当前测速最优节点耗时 大于  tolerance时才会进行节点切换，默认0)
# fallback模式, 和url-test类似, 不同的是会根据顺序返回第一个可用的节点, 为了避免资源浪费, 建议节点数不要过多, 只支持单个节点和远端节点, 其他会被忽略
# Load-Balance:负载均衡, 根据选择的负载均衡算法选择子策略, 目前三种算法:
#   -Random:随机选择子策略
#   -PCC:基于Random, 不同于Random, PCC会让相同主机名的请求锁定同一节点
#   -Round-Robin:轮询选择子策略
#  
# 由于负载均衡策略, 并不是所有机场都能适用, 所以请自己手动设置负载均衡策略组：
#  （PS.请选择同地区节点, 并且遵从各机场的最大IP限制数, 该机场节点选择数量应小于限制数）
# 网易云音乐灰色歌曲,需要节点支持解锁

[General]
# IPv6 支持
ipv6 = false
# > 跳过某个域名或者IP段
skip-proxy = 192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,localhost,*.local,e.crashlynatics.com
bypass-tun = 10.0.0.0/8,100.64.0.0/10,127.0.0.0/8,169.254.0.0/16,172.16.0.0/12,192.0.0.0/24,192.0.2.0/24,192.88.99.0/24,192.168.0.0/16,198.18.0.0/15,198.51.100.0/24,203.0.113.0/24,224.0.0.0/4,255.255.255.255/32
# DNS 服务器
dns-server = system,119.29.29.29
# Wi-Fi 访问
# > 允许 Wi-Fi 网络下其它设备访问
allow-udp-proxy = false
allow-wifi-access = false
wifi-access-http-port = 7222
wifi-access-socket5-port = 7221
# > 代理测速 URL
proxy-test-url = http://www.gstatic.com/generate_204
# > 测速超时 (s)
test-timeout = 3
# 解析器
resource-parser = https://raw.githubusercontent.com/Peng-YM/Sub-Store/master/scripts/sub-store-parser.js

[Host]

[Proxy]
# 本地节点
# 内置 DIRECT、REJECT 策略
# 节点名称 = 协议, 服务器地址, 服务器端口, 加密协议, 密码, 
# vmess
# 节点名称 = 协议, 服务器地址, 端口, 加密方式, UUID, 传输方式:(tcp/ws),path：websocket握手header中的path, host：websocket握手header中的path, over-tls:是否tls, tls-name：远端w服务器域名, skip-cert-verify：是否跳过证书校验（默认否）
#5 = vmess, 1.2.3.4, 10086, aes-128-gcm,”uuid“,transport:ws,path:/,host:icloud.com,over-tls:true,tls-name:youtTlsServerName.com,skip-cert-verify:false

[Remote Proxy]
# 订阅节点
# 别名 = 订阅URL
网易解锁 = https://git.io/JfNq3, parser-enable = true

[Proxy Group]
FINAL = select,DIRECT
proxy = select,DIRECT

[Remote Filter]
# 筛选订阅节点, 筛选后的结果可加入到策略组中, 目前支持三种筛选方式
# NodeSelect: 使用在UI上选择的节点。
# NameKeyword: 根据提供的关键词对订阅中所有节点的名称进行筛选, 使用筛选后的节点。
# NameRegex: 根据提供的正则表达式对订阅中所有节点的名称进行筛选, 使用筛选后的节点。

[Remote Rule]
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Advertising.list, policy=REJECT, tag=去广告,enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Hijacking.list, policy=REJECT, tag=去广告,enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Privacy.list, policy=REJECT, tag=去广告,enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/TestFlight/TestFlight.list, policy=proxy, tag=TestFlight, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Apple/Apple.list, policy=FINAL, tag=苹果服务, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/YouTube/YouTube.list, policy=proxy, tag=油管视频, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Netflix/Netflix.list, policy=proxy, tag=奈飞视频, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/GlobalMedia/GlobalMedia.list, policy=proxy, tag=国外媒体, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/BiliBili/BiliBili.list, policy=FINAL, tag=国内媒体, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Telegram/Telegram.list, policy=proxy, tag=电报消息, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Proxy/Proxy.list, policy=proxy, tag=全球规则, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Proxy/Proxy_Domain.list, policy=proxy, tag=全球规则,enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/China/China.list, policy=DIRECT, tag=全球直连, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Speedtest/Speedtest.list, policy=proxy, tag=Speedtest, enabled=true

[Rule]
DOMAIN, rsshub.app, proxy

GEOIP,CN,DIRECT
FINAL,FINAL

[URL Rewrite]
enable = true

[Remote Rewrite]
https://raw.githubusercontent.com/Tartarus2014/For-own-use/master/Loon/Advertising.conf, tag=Advertising, enabled=false

[Script]
enable = false

[Remote Script]
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/script/smzdm/smzdm_remove_ads.lnscript, tag=什么值得买_去广告, enabled=true
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Cookie.conf, tag=Cookie.获取完一定要关闭, enabled=false
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Task.conf, tag=Task, enabled=false
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Script.conf, tag=Script, enabled=false

[Plugin]
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Plugin/Host.plugin, tag=Host, enabled=true
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Plugin/Block/Advertising.plugin, proxy=REJECT, tag=Advertising, enabled=true
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Plugin/General.plugin, tag=General, enabled=true
https://gitee.com/chavyleung/scripts/raw/master/box/rewrite/boxjs.rewrite.loon.tf.plugin, tag=Boxjs, enabled=true
https://raw.githubusercontent.com/Peng-YM/Sub-Store/master/config/Loon.plugin, tag=订阅解析器, enabled=false
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/script/bilibili/bilibili_plus.lnplugin, tag=哔哩哔哩_去广告, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/script/zhihu/zhihu_plus.lnplugin, tag=知乎助手_去广告及体验增强, enabled=true
https://raw.githubusercontent.com/Tartarus2014/For-own-use/master/Loon/Plugin/Profile.plugin, tag=Profile, enabled=true
https://subweb.oss-cn-hongkong.aliyuncs.com/Module/embyUnlocked.plugin, tag=EMBY, enabled=true
https://raw.githubusercontent.com/Tartarus2014/For-own-use/master/Loon/Plugin/TikTokJP.plugin, proxy=proxy, tag=Tiktok, enabled=true
https://raw.githubusercontent.com/Tartarus2014/For-own-use/master/Loon/Plugin/RSS.plugin, proxy=PROXY, tag=RSS, enabled=true
https://raw.githubusercontent.com/Tartarus2014/For-own-use/master/Loon/Plugin/SMZDM.plugin, proxy=REJECT, tag=SMZDM, enabled=true
https://raw.githubusercontent.com/Tartarus2014/For-own-use/master/Loon/Plugin/ZhiHu.plugin, proxy=REJECT, tag=ZhiHu, enabled=true
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Plugin/Block/YouTubeAdsTest.plugin, tag=Host, enabled=true
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Plugin/Historical%20Price.plugin, tag=Host, enabled=true


[MITM]
enable = false
skip-server-cert-verify = true
